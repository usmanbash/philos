{%- doc -%}
  Renders a "Fabric" module on PDP.

  @description Reusable snippet for fabric module.

  @param {object} image - The image of the section

  @example
  {% render 'fabric', image: image %}

{%- enddoc -%}

{%- liquid
  
  # get default fabric metaobject
  assign default_fabric_metaobject = shop.metaobjects.fabric_features.values | first
  
  assign title = default_fabric_metaobject.title
  assign headline = default_fabric_metaobject.headline
  assign items = default_fabric_metaobject.features.value

  if image == blank
    assign image = default_fabric_metaobject.image
  endif
%}

<div
  data-scroll
  data-scroll-repeat
  data-scroll-call="inViewportAnimation"
  class="fabric w-full px-5 sm:px-10 md:pr-0 my-14">

  {%- comment -%} Fabric Card {%- endcomment -%}
  <div class="fabric-card grid grid-cols-1 xl:grid-cols-12 gap-y-14">

    {%- comment -%} Text Content {%- endcomment -%}
    <div class="fabric-card__content-wrapper xl:col-start-1 xl:col-span-5 order-2 xl:order-1 lg:pr-10">
      <div class="fabric-card__text-content flex flex-col justify-center gap-6 lg:gap-8 w-full h-full">

        {% comment %} Headline {% endcomment %}
        {%- if headline != blank -%}
          <div class="content font-ivar text-24 lg:text-30">
            {{ headline | metafield_tag }}
          </div>
        {%- endif -%}

        {%- comment -%} Fabric Features (Accordion) {%- endcomment -%}
        <div class="w-full">
          {%- for item in items -%}
            {%- liquid
              assign description = item.description | metafield_tag
            -%}
            {% render 'accordion'
              , title: item.title
              , content: description
              , accordion_wrapper_class: "border-b border-gray"
              , accordion_class: "pt-8 pb-3 flex items-center justify-between cursor-pointer"
              , title_class: "text-16 md:text-18 font-medium"
              , content_class: "content pt-4 pb-10 text-14 text-gray-700"
              , accordion_plus_class: "flex-shrink-0"
              , id: forloop.index
            %}
          {%- endfor -%}
        </div>

      </div>
    </div>

    {%- comment -%} Image Wrapper {%- endcomment -%}
    <div class="fabric-card__image-wrapper xl:col-start-6 xl:col-span-7 order-1 xl:order-2">
      {%- if image != blank -%}
        {%- render 'scale-down-image'
          , image: image
          , originalRatio: false
          , imgRatio: 0.82
          , className: 'w-full h-full object-cover'
        -%}
      {%- endif -%}
    </div>
  
  </div>
</div>