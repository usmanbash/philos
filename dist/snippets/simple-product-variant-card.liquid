{%- comment -%}
Snnipet: Simple Product Variant Card
Description: A snippet that displays a simple product variant card (front end component)
{%- endcomment -%}

<div
  x-data='productVariantCard({
    variants
  })'
  class="product-variant-card relative w-full {{ color_classes }}">
  {%- comment -%} Card Body{%- endcomment -%}
  <div class="card-body">

    {% comment %} CARD TOP {% endcomment %}
    <div class="relative flex aspect-[.82]">
      {% comment %} IMAGE AND QUICK BUY {% endcomment %}
      <div
        class="image-and-quick-buy__wrapper relative flex flex-col w-full h-full overflow-hidden"
        @mouseenter="showProductCardImages"
        @mouseleave="resetProductImage">

        <a
          x-ref="imageAndQuickBuyWrapper"
          :href='firstAvailableVariantUrl'
          :aria-label="`${variants[0]?.displayTitle}`"
          class="flex flex-col w-full h-full cursor-pointer">
          <div class="product-variant-card__images relative flex flex-col w-full h-full bg-gray-100">
            <div class="product-variant-card__image {{ image_scale }}">
              <template x-if='variants[0]?.image?.url'>
                <img
                  x-ref='productImage'
                  :src='variants[0]?.image?.url'
                  :alt='variants[0]?.image?.alt'
                  loading='lazy'
                  class='product-card-image featured absolute top-0 left-0 w-full h-full object-cover object-center opacity-100' />
              </template>
              <template x-else>
                <img
                  src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="
                  alt="Image Placeholder"
                  class='product-card-image featured absolute top-0 left-0 w-full h-full object-cover object-center opacity-100' />
              </template>
            </div>
            {% render 'product-card-images' %}
          </div>
        </a>

        {%- comment -%} SIZES PANEL {%- endcomment -%}
        <div
          :class="{
            'translate-y-0': !isSizeSelectorOpened,
            '-translate-y-full': isSizeSelectorOpened
          }"
          class="available-sizes__wrapper bg-white3 w-full lg:pb-5 pt-7 absolute left-0 bottom-auto top-full transition duration-500 z-20 pointer-events-auto"
          @mouseleave="closeSizeSelector($event)"
          @click.stop.prevent="closeSizeSelector($event)">
          <div class="flex items-center mb-4 text-black {{ padding_classes }}">
            <div class="available-sizes__label text-16">{{ 'product.size_guide.select_eu_size' | t }}</div>
            <button type="button" aria-label="{{ 'product.size_guide.title' | t }}"
              class="available-sizes__size-guide-label link link--reversed ml-auto text-16 lg:text-14 xl:text-16 uppercase"
              @click.prevent='setSizeGuide(variants[0])'>
              {{ 'product.size_guide.title' | t }}
            </button>
          </div>

          {% comment %} LIST SIZES {% endcomment %}
          <div class="available-sizes flex gap-5 text-16 lg:text-14 xl:text-16 {{ padding_classes }} overflow-x-auto invisible-scrollbar">

            <template x-for='variant in variants'>
              <div>
                <template x-if='variant.availableForSale'>
                  <a
                    x-html='getVariantSize(variant)'
                    :href="variant?.url"
                    :aria-label="`${variant?.displayTitle} | ${getVariantSize(variant)}`"
                    :data-variant-id="variant?.id"
                    :data-variant-inventory-quantity="variant?.quantityAvailable"
                    class="size size--available inline-block text-black uppercase cursor-pointer"
                    @click.stop.prevent='quickAddToCart($event)'>
                  </a>
                </template>

                <template x-if='!variant.availableForSale'>
                  <span
                    x-html='getVariantSize(variant)'
                    class="size size--unavailable text-gray uppercase">
                    {{ size}}
                  </span>
                </template>
              </div>
            </template>
          </div>
          {% comment %} END :: LIST SIZES {% endcomment %}

        </div>
        {% comment %} END :: SIZES PANEL {% endcomment %}

      </div>
      {% comment %} END :: QUICK BUY {% endcomment %}

      {% comment %} BTN AND AVAILABILITY {% endcomment %}
      <div
        class="product-availability__wrapper text-16 absolute right-0 top-0 text-black z-10 p-4 w-full h-full flex flex-col justify-between items-end pointer-events-none">
        <span x-html='getProductAvailability(variants)' class="product-availability-status"></span>
        {% comment %} {% render 'product-availability' %} {% endcomment %}
        {% comment %} QUICK BUY BTN {% endcomment %}
        <div class="quick-buy__wrapper w-[39px] h-[39px] z-10 pointer-events-auto">
          <button
            type="button"
            aria-label="{{ 'general.quick_buy' | t }}"
            x-bind:data-variant-id="variantId ? variantId : null"
            x-bind:data-variant-inventory-quantity="variantInventoryQuantity > 0 ? variantInventoryQuantity : null"
            :disabled="!availableSizes && !productAvailable"
            class="quick-buy__btn flex items-center justify-center w-full h-full bg-gray rounded-full z-10"
            :class="{ 'opacity-50 pointer-events-none': !availableSizes && !productAvailable }"
            @click.prevent="handleQuickAtcOrSizeSelector($event)">
            <span class="pointer-events-none">
              {% render 'icon-plus' %}
            </span>
          </button>
        </div>
        {% comment %} END :: QUICK BUY BTN {% endcomment %}
      </div>
      {% comment %} END :: BTN AND AVAILABILITY {% endcomment %}
    </div>
    {% comment %} END :: CARD TOP {% endcomment %}

    {%- comment -%} TITLE AND PRICE {%- endcomment -%}
    
    <div class="product-varaint-card__content flex flex-row flex-nowrap justify-between items-center pt-5 text-16">
      {% liquid
        assign display_title = product.title
        if color != blank
          assign display_title = display_title | append: ' | ' | append: color
        endif
      %}
      <a 
      href="{{ product_variant_url }}" 
      :href='firstAvailableVariantUrl' 
      :aria-label="`${variants[0]?.displayTitle}`"
      class="inline-block cursor-pointer">
        <h3 
          x-html='variants[0]?.displayTitle' 
          class="product-title font-normal"
        >
        {{ display_title }}
        </h3>
      </a>
      
      <p x-html="formattedPrice" class="product-price"></p>
    </div>

  </div>

</div>
