{%- comment -%}
  Snippet: Variant Selector
  Description: A snippet that displays the variant selector for a product

  Accepts:
    - id (string) - section id
    - product (product) - product object

  Usage:
    {% render 'variant-selector',
      id: section.id,
      product: product
    %}
{%- endcomment -%}

<div class="mt-3 variant-selector">
  {%- unless product.has_only_default_variant -%}
    <div
      data-url="{{ product.url }}"
      data-section="{{ id }}"
      class="flex flex-col text-font-base">
      {%- for option in product.options_with_values -%}
        {%- liquid
          # Assign order class based on option name
          case option.name
            when 'Color'
              assign color_option_index = option.position
              assign order_class = 'order-1 border-b border-gray pb-5 mb-5'
            when 'Size'
              assign order_class = 'order-2'
            else
              assign order_class = 'order-3 hidden'
          endcase

          # Dynamically access the color and size based on their determined indexes
          assign color_option = 'option' | append: color_option_index

        -%}
          <div class='{{ order_class }}'>
          <div class="option option--{{ option.name }}">
            {%- case option.name -%}
              {% comment %} COLOR VARIANT SELECTOR {% endcomment %}
              {%- when 'Color' -%}
                {%-
                  render 'color-selector',
                  color_option: color_option,
                  options: option.values,
                  index: forloop.index
                -%}

              {% comment %} SIZE VARIANT SELECTOR {% endcomment %}
              {%- when 'Size' -%}
                {%-
                  render 'size-selector',
                  options: option.values,
                  index: forloop.index
                -%}

              {% comment %} DEFAULT VARIANT SELECTOR
              {%- else -%}
                {%-
                  render 'default-selector',
                  option_name: option.name,
                  option: option
                -%}
              {% endcomment %}

            {%- endcase -%}

          </div>
        </div>
      {%- endfor -%}
    </div>
  {%- endunless -%}
</div>
